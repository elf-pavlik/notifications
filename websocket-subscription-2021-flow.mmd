sequenceDiagram
  autonumber
  participant Subscriber
  participant Storage Metadata Resource
  participant Subscriptions Container
  participant Authorization Server
  participant Notifications Source

  Subscriber ->> Storage Metadata Resource: Discovery
  Storage Metadata Resource ->> Subscriber: Storage Metadata Resource
  Subscriber ->> Subscriptions Container: Request WebSocketsSubscription2021 (with access token)
  Subscriptions Container ->> Authorization Server: Verify authorization
  Authorization Server ->> Subscriptions Container: capabilities
  Subscriptions Container ->> Subscriber: Subscription response (with wss: notifications source)
  Subscriber ->> Notifications Source: Establish WebSockets connection
  Notifications Source -->> Subscriber: Stream notifications
